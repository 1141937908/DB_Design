CREATE DATABASE DB_Design;
USE DB_Design;
/*创建表*/
CREATE TABLE Users
(
 Uno     VARCHAR(20) NOT NULL PRIMARY KEY ,
 Upasswd VARCHAR(20) NOT NULL ,
 Uname   VARCHAR(10) NOT NULL
);
CREATE TABLE Classes
(
 Cno   VARCHAR(8)   NOT NULL PRIMARY KEY ,
 Cname VARCHAR(20)  ,
 Cnum  SMALLINT     NOT NULL
);
CREATE TABLE Teacher
(
 Tno   CHAR(20) NOT NULL  PRIMARY KEY ,
 Tname CHAR(8)  NOT NULL ,
 Tsex  CHAR(2)  NOT NULL
);
CREATE TABLE Lesson
(
 Lno   VARCHAR(10) NOT NULL PRIMARY KEY ,
 Lname VARCHAR(40) NOT NULL
);
CREATE TABLE Book
(
 Bno      VARCHAR(13)  NOT NULL PRIMARY KEY ,
 Bname    VARCHAR(100) NOT NULL ,
 Bpublish VARCHAR(30)  NOT NULL ,
 Bwriter  VARCHAR(100) NOT NULL ,
 Bprice   DOUBLE       NOT NULL ,
 Bnum     SMALLINT     NOT NULL
);
CREATE TABLE Subscription
(
 Cno  VARCHAR(8)  NOT NULL ,
 Tno  VARCHAR(20) NOT NULL ,
 Lno  VARCHAR(10) NOT NULL ,
 Bno  VARCHAR(13) NOT NULL ,
 Onum SMALLINT NOT NULL ,
 PRIMARY KEY (Cno,Tno,Lno),
 FOREIGN KEY (Cno) REFERENCES Classes(Cno) ,
 FOREIGN KEY (Tno) REFERENCES Teacher(Tno) ,
 FOREIGN KEY (Lno) REFERENCES Lesson(Lno) ,
 FOREIGN KEY (Bno) REFERENCES Book(Bno)
);
CREATE TABLE Give
(
 Cno   VARCHAR(8)  NOT NULL ,
 Tno   VARCHAR(20) NOT NULL ,
 Lno   VARCHAR(10) NOT NULL ,
 Bno   VARCHAR(13) NOT NULL ,
 Gs    BIT         NOT NULL ,
 Gdata DATETIME,
 PRIMARY KEY (Cno, Tno, Lno),
 FOREIGN KEY (Cno) REFERENCES Classes (Cno),
 FOREIGN KEY (Tno) REFERENCES Teacher (Tno),
 FOREIGN KEY (Lno) REFERENCES Lesson (Lno),
 FOREIGN KEY (Bno) REFERENCES Book (Bno)
);
CREATE TABLE Relation
(
 Cno VARCHAR(8)  NOT NULL ,
 Tno VARCHAR(20) NOT NULL ,
 Lno VARCHAR(10) NOT NULL ,
 Bno VARCHAR(13) NOT NULL ,
 PRIMARY KEY (Cno,Tno,Lno),
 FOREIGN KEY (Cno) REFERENCES Classes(Cno) ,
 FOREIGN KEY (Tno) REFERENCES Teacher(Tno) ,
 FOREIGN KEY (Lno) REFERENCES Lesson(Lno) ,
 FOREIGN KEY (Bno) REFERENCES Book(Bno)
);